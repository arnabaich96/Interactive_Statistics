---
title: "One Sample Hypothesis Testing for $\\mu$"
author: "Arnab Aich"
output: 
  html_document:
    self_contained: yes
    toc: true
    toc_float: true
    toc_depth: 4
    theme: cerulean
---
<link rel="stylesheet" type="text/css" href="../styles.css">

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, comment = NA, warning = FALSE, message = FALSE,fig.align = 'center',out.width = '100%')
library(plotly)
library(ggplot2)
library(kableExtra)
```


Hypothesis testing is a critical statistical tool used to make inferences about population parameters using sample data. In particular, one-sample hypothesis testing allows us to test claims about the population mean ($\mu$) based on a sample from that population. The process involves comparing the sample mean to a hypothesized value under the assumption that the null hypothesis is true.

Hypothesis testing involves the following key steps:
1. Formulating the null and alternative hypotheses.
2. Choosing a significance level ($\alpha$).
3. Calculating the appropriate test statistic.
4. Determining the p-value or comparing the test statistic to critical values.
5. Making a decision to reject or fail to reject the null hypothesis.

## Key Terms and Definitions

### Null Hypothesis (\(H_0\))

The null hypothesis is the default assumption or claim that there is no effect or no difference. In hypothesis testing for the population mean, it often states that the mean equals a specific value. 

**Example**
\[
H_0: \mu = \mu_0
\]
where \(\mu_0\) is the hypothesized population mean. <u>Null Hypothesis is set under plausible reaction.</u>

### Alternative Hypothesis (\(H_A\))

The alternative hypothesis is what we aim to provide evidence for; it suggests that there is a significant effect or difference. For one-sample hypothesis testing of the population mean, it takes one of the following forms:

- Two-tailed: \( H_A: \mu \neq \mu_0 \)

- Right-tailed: \( H_A: \mu > \mu_0 \)

- Left-tailed: \( H_A: \mu < \mu_0 \)

### Type I Error (\(\alpha\))

A Type I error occurs when the null hypothesis is rejected when it is actually true. The probability of making a Type I error is denoted by \(\alpha\), and it is also called the **significance level**.

### Type II Error (\(\beta\))

A Type II error occurs when the null hypothesis is not rejected when the alternative hypothesis is true. The probability of making a Type II error is denoted by \(\beta\).

### Significance Level (\(\alpha\))

The significance level, also called \(\alpha\), is the threshold we set for rejecting the null hypothesis. Common values of \(\alpha\) are 0.05, 0.01, and 0.10, which represent a 5%, 1%, and 10% risk of committing a Type I error.

### Power of a Test

The power of a hypothesis test is the probability of correctly rejecting the null hypothesis when it is false (i.e., rejecting \(H_0\) when \(H_A\) is true). It is calculated as:

\[
\text{Power} = 1 - \beta
\]

### p-value

The p-value is the probability of obtaining test results at least as extreme as the results observed, under the assumption that the null hypothesis is true. It helps us quantify the evidence against the null hypothesis.

- **If the p-value is less than or equal to \(\alpha\)**, we reject the null hypothesis.
- **If the p-value is greater than \(\alpha\)**, we fail to reject the null hypothesis.

### Critical Value

The critical value is the cutoff point that defines the rejection region of the hypothesis test. It depends on the chosen significance level \(\alpha\) and the type of test (two-tailed, right-tailed, or left-tailed).

For example, in a two-tailed test with \(\alpha = 0.05\), the critical values are the points that correspond to the upper and lower 2.5% of the distribution.



## Z-Test (Population Standard Deviation Known)

### Assumptions

1. The data is a simple random sample from the population.
2. The population from which the sample is drawn is normally distributed or the sample size is sufficiently large (by the Central Limit Theorem).
3. The population standard deviation $\sigma$ is known .


### Step 1: Hypotheses

- **Null Hypothesis (\(H_0\)):**  
  \(H_0: \mu = \mu_0\)  
  The population mean is equal to the hypothesized mean \(\mu_0\).

- **Alternative Hypothesis (\(H_A\)):**  
  The alternative hypothesis depends on the test type:
  
  - **Right-tailed test:** \(H_A: \mu > \mu_0\)  
  The population mean is greater than the hypothesized mean.
  
  - **Left-tailed test:** \(H_A: \mu < \mu_0\)  
  The population mean is less than the hypothesized mean.
  
  - **Two-tailed test:** \(H_A: \mu \neq \mu_0\)  
  The population mean is different from the hypothesized mean.

### Step 2: Test Statistic

To test the hypotheses, the Z-statistic is calculated using the formula:
\[
Z = \frac{\sqrt{n}(\bar{X} - \mu_0)}{\sigma}
\]
where:

- \(\bar{X}\) is the sample mean,

- \(\mu_0\) is the hypothesized population mean,

- \(\sigma\) is the population standard deviation,

- \(n\) is the sample size.

### Step 3: Distribution under the Null Hypothesis

Under the null hypothesis, the test statistic follows a standard normal distribution (Z-distribution) with a mean of 0 and a standard deviation of 1:
\[
Z \sim N(0, 1)
\]
Also the sampling distribution of the sample mean is normally distributed by the Central Limit Theorem.
\[
\bar{X} \sim N \left(\mu, \frac{\sigma}{\sqrt{n}}\right)
\]

### Step 4: Critical Value

The critical value is determined by the significance level \(\alpha\) and the type of test (one-tailed or two-tailed):

- For a **right-tailed test**, the critical value \(Z_{\alpha}\) corresponds to the area under the normal curve to the right of \(Z_{\alpha}\).

- For a **left-tailed test**, the critical value \(Z_{\alpha}\) corresponds to the area under the normal curve to the left of \(Z_{\alpha}\).

- For a **two-tailed test**, the critical values correspond to the areas in both tails of the distribution (i.e., \(\alpha/2\) in each tail).

For example, for a significance level of \(\alpha = 0.05\):
- **Right-tailed test:** The critical value is \(Z_{0.05} = 1.645\).

- **Left-tailed test:** The critical value is \(Z_{0.05} = -1.645\).

- **Two-tailed test:** The critical values are \(\pm Z_{0.025} = \pm 1.96\).

### Step 5: p-value Calculation

Once the test statistic is computed, the p-value is calculated based on the type of test:

- **Right-tailed test:**  
  The p-value is the probability of obtaining a test statistic greater than the observed \(Z\)-value:
  \[
  p = P(Z > Z_{\text{calculated}})
  \]
  
- **Left-tailed test:**  
  The p-value is the probability of obtaining a test statistic less than the observed \(Z\)-value:
  \[
  p = P(Z < Z_{\text{calculated}})
  \]

- **Two-tailed test:**  
  The p-value is the probability of obtaining a test statistic as extreme as the observed \(Z\)-value in either direction:
  \[
  p = 2 \times P(Z > |Z_{\text{calculated}}|)
  \]
  
### Step 6: Conclusion

- **If the p-value is less than or equal to the significance level \(\alpha\):**  
  Reject the null hypothesis \(H_0\). There is sufficient evidence to support the alternative hypothesis \(H_A\).

- **If the p-value is greater than \(\alpha\):**  
  Fail to reject the null hypothesis \(H_0\). There is insufficient evidence to support the alternative hypothesis.

#### Example

Suppose we are testing whether the average height of a population is 170 cm. A sample of 50 individuals has a mean height of 172 cm, and the population standard deviation is 6 cm. Let’s perform a two-tailed test at \(\alpha = 0.05\).

- **Step 1: Hypotheses:**
  - \(H_0: \mu = 170\)
  
  - \(H_A: \mu \neq 170\)

- **Step 2: Test Statistic:**
  \[
  Z = \frac{\sqrt{50} (172 - 170)}{6} = \frac{2 \times 7.071}{6} \approx 2.36
  \]

- **Step 3: Distribution under \(H_0\):**  
  \(Z \sim N(0, 1)\)

- **Step 4: Critical Values:**  
  For a two-tailed test at \(\alpha = 0.05\), the critical values are \(Z = \pm 1.96\).

- **Step 5: p-value Calculation:**
  \[
  p = 2 \times P(Z > 2.36) = 2 \times 0.0091 = 0.0182
  \]

- **Step 6: Conclusion:**
  Since \(p = 0.0182 < 0.05\), we reject \(H_0\). There is sufficient evidence to conclude that the population mean height is different from 170 cm.
  
  
```{r echo=FALSE}
# Z-Test Example Data
z_alpha <- 1.96  # Critical value for a two-tailed test, alpha = 0.05
z_stat <- 2.36  # Test statistic
x <- seq(-4, 4, length=1000)
# Plot for Z-Test (two-tailed)
 ggplot(data = data.frame(x=x), aes(x=x)) +
  stat_function(fun = dnorm, geom = "line", color="black") +
  geom_area(stat="function", fun=dnorm, xlim=c(-4, -z_alpha), fill="red", alpha=0.3) +
  geom_area(stat="function", fun=dnorm, xlim=c(z_alpha, 4), fill="red", alpha=0.3) +
  geom_vline(xintercept = z_stat, color = "blue", linetype = "dashed") +
  geom_vline(xintercept = c(-z_alpha, z_alpha), color = "red", linetype = "dashed") +
  ggtitle("Z-Test: Two-tailed Test for Population Mean") +
  xlab("Z") + ylab("Density") +
  theme_minimal()
```

- **Black Line:** Represents the normal curve.

- **Red Shaded Region:** Indicates the critical region where the null hypothesis would be rejected.

- The critical region is on both side.
  
- **Red Dashed Lines:** Represent the critical values corresponding to the significance level (\(\alpha\)).

- **Blue Dashed Line:** Represents the test statistic value calculated from the data.


## t-Test (Population Standard Deviation Unknown)

### Assumptions

1. The data is a simple random sample from the population.
2. The population from which the sample is drawn is normally distributed or the sample size is sufficiently large (by the Central Limit Theorem).
3. The population standard deviation $\sigma$ is not known (it will be estimated by sample sd $S$).

### Step 1: Hypotheses

- **Null Hypothesis (\(H_0\)):**  
  \(H_0: \mu = \mu_0\)  
  The population mean is equal to the hypothesized mean \(\mu_0\).

- **Alternative Hypothesis (\(H_A\)):**  
  - **Right-tailed test:** \(H_A: \mu > \mu_0\)  
    The population mean is greater than the hypothesized mean.

### Step 2: Test Statistic

Since the population standard deviation \(\sigma\) is unknown, we use the t-statistic:
\[
t = \frac{\bar{X} - \mu_0}{\frac{s}{\sqrt{n}}}
\]
where:

- \(\bar{X}\) is the sample mean,

- \(\mu_0\) is the hypothesized population mean,

- \(s\) is the sample standard deviation,

- \(n\) is the sample size.

### Step 3: Distribution under the Null Hypothesis

Under the null hypothesis, the test statistic follows a t-distribution with \(n - 1\) degrees of freedom:
\[
t \sim t(n - 1)
\]

### Step 4: Critical Value

The critical value is determined by the significance level \(\alpha\) and the type of test (right-tailed in this case):
- For a **right-tailed test**, the critical value \(t_{\alpha, n-1}\) corresponds to the area to the right of the critical t-value in the t-distribution.

For example, if \(\alpha = 0.05\) and \(n = 20\) (so degrees of freedom = 19), the critical value is:
\[
t_{0.05, 19} \approx 1.729
\]

### Step 5: p-value Calculation

Once the test statistic is computed, the p-value is calculated as:
\[
p = P(t > t_{\text{calculated}})
\]
where \(t_{\text{calculated}}\) is the computed test statistic, and the p-value is determined using the t-distribution with \(n - 1\) degrees of freedom.

### Step 6: Conclusion

- **If the p-value is less than or equal to the significance level \(\alpha\):**  
  Reject the null hypothesis \(H_0\). There is sufficient evidence to support the alternative hypothesis \(H_A\).

- **If the p-value is greater than \(\alpha\):**  
  Fail to reject the null hypothesis \(H_0\). There is insufficient evidence to support the alternative hypothesis.

#### Example:

Suppose we are testing whether the average IQ of a group of students is greater than 100. A sample of 25 students has a mean IQ of 104 with a sample standard deviation of 10. Let’s perform a right-tailed t-test at \(\alpha = 0.05\).

- **Step 1: Hypotheses:**
  - \(H_0: \mu = 100\)
  
  - \(H_A: \mu > 100\) (right-tailed test)

- **Step 2: Test Statistic:**
  \[
  t = \frac{104 - 100}{\frac{10}{\sqrt{25}}} = \frac{4}{2} = 2.0
  \]

- **Step 3: Distribution under \(H_0\):**  
  \(t \sim t(24)\) (since \(n - 1 = 25 - 1 = 24\))

- **Step 4: Critical Value:**  
  For a right-tailed test with \(\alpha = 0.05\) and 24 degrees of freedom, the critical value is approximately:
  \[
  t_{0.05, 24} \approx 1.711
  \]
  Since \(t_{\text{calculated}} = 2.0\) exceeds the critical value, this suggests rejection of the null hypothesis.

- **Step 5: p-value Calculation:**
  Using the t-distribution table or a calculator, the p-value is:
  \[
  p = P(t > 2.0) \approx 0.029
  \]

- **Step 6: Conclusion:**
  Since \(p = 0.029 < 0.05\), we reject \(H_0\). There is sufficient evidence to conclude that the average IQ of the group of students is greater than 100.


```{r echo=FALSE}
# t-Test Example Data
t_alpha <- 1.711  # Critical value for right-tailed test with 24 df, alpha = 0.05
t_stat <- 2.0
df <- 24
x_t <- seq(-4, 4, length=1000)
# Plot for t-Test (right-tailed)
 ggplot(data = data.frame(x=x_t), aes(x=x_t)) +
  stat_function(fun = dt, args=list(df=df), geom = "line", color="black") +
  geom_area(stat="function", fun=dt, args=list(df=df), xlim=c(t_alpha, 4), fill="red", alpha=0.3) +
  geom_vline(xintercept = t_stat, color = "blue", linetype = "dashed") +
  geom_vline(xintercept = t_alpha, color = "red", linetype = "dashed") +
  ggtitle("t-Test: Right-tailed Test for Population Mean") +
  xlab("t") + ylab("Density") +
  theme_minimal()
```

- **Black Line:** Represents the t-distribution curve.

- **Red Shaded Region:** Indicates the critical region where the null hypothesis would be rejected.

- the critical region is on the right side only.
  
- **Red Dashed Lines:** Represent the critical values corresponding to the significance level (\(\alpha\)).

- **Blue Dashed Line:** Represents the test statistic value calculated from the data.



## Recap

In this document, we have covered the following concepts:

1. **One-Sample Hypothesis Testing**: We discussed how to perform hypothesis tests on the population mean ($\mu$) using sample data, including both Z-tests (when the population standard deviation is known) and t-tests (when the population standard deviation is unknown).
   
2. **Null Hypothesis ($H_0$)**: The null hypothesis represents the claim we test, often that the population mean equals a specific value ($\mu_0$). For example, $H_0: \mu = \mu_0$.
   
3. **Alternative Hypothesis ($H_A$)**: The alternative hypothesis is the claim we aim to support, which opposes the null hypothesis. It can be two-tailed ($\mu \neq \mu_0$), right-tailed ($\mu > \mu_0$), or left-tailed ($\mu < \mu_0$).
   
4. **Test Statistics**: We learned how to compute the Z-statistic when the population standard deviation ($\sigma$) is known and the t-statistic when $\sigma$ is unknown.
   
5. **p-value and Critical Values**: The p-value helps determine the significance of the results by comparing the test statistic to a threshold defined by the significance level ($\alpha$). We also explored how to compare the test statistic to critical values.
   
6. **Decision Making**: Based on the p-value or critical value approach, we either reject or fail to reject the null hypothesis.



## Q&A Section

Below are ten key questions and answers related to one-sample hypothesis testing for the population mean ($\mu$):

### 1. What is the purpose of hypothesis testing?
**Answer:** Hypothesis testing is used to make decisions about a population parameter based on sample data, by testing a null hypothesis against an alternative hypothesis.

### 2. What are the null and alternative hypotheses in one-sample hypothesis testing?
**Answer:** 
- The **null hypothesis** ($H_0$) asserts that the population mean equals a specific value ($\mu_0$). 
- The **alternative hypothesis** ($H_A$) suggests that the population mean is different from ($\mu_0$).

### 3. What is a p-value?
**Answer:** A p-value is the probability of observing a test statistic as extreme as, or more extreme than, the observed value, assuming the null hypothesis is true.

### 4. When do you reject the null hypothesis?
**Answer:** The null hypothesis is rejected if the p-value is less than or equal to the significance level ($\alpha$), or if the test statistic falls in the critical region.

### 5. What is the difference between a one-tailed and two-tailed test?
**Answer:** 
- A **one-tailed test** checks whether the population mean is either greater than or less than the hypothesized value.
- A **two-tailed test** checks whether the population mean is different (either greater or less) than the hypothesized value.

### 6. What is a Type I error?
**Answer:** A Type I error occurs when we incorrectly reject the null hypothesis when it is true (false positive).

### 7. What is a Type II error?
**Answer:** A Type II error occurs when we fail to reject the null hypothesis when it is false (false negative).

### 8. What is the test statistic in a Z-test?
**Answer:** The test statistic in a Z-test is:
\[
Z = \frac{\sqrt{n}(\bar{X} - \mu_0)}{\sigma}
\]
where $\bar{X}$ is the sample mean, $\mu_0$ is the hypothesized mean, $\sigma$ is the population standard deviation, and $n$ is the sample size.

### 9. When do you use a t-test instead of a Z-test?
**Answer:** A t-test is used when the population standard deviation is unknown, and we rely on the sample standard deviation to estimate it.

### 10. What is the critical value?
**Answer:** A critical value is a point on the test statistic distribution that defines the boundary of the rejection region. If the test statistic exceeds the critical value, the null hypothesis is rejected.

---
